# Today I Learned - 2022/12/29 Thur

# 그룹함수와 집계함수
## 그룹함수
|학번|이름|학기|과목|점수|
|:---:|:---:|:---:|:---:|:---:|
|0001|이흥직|1|영어|80|
|0001|이흥직|1|수학|75|
|0002|김보연|1|영어|90|
|0002|김보연|1|수학|70|
|0001|이흥직|2|영어|95|
|0001|이흥직|2|수학|70|
|0002|김보연|2|영어|85|
|0002|김보연|2|수학|75|

<br>

### GROUP BY
- 학번별로 총점과 평균 구하기

```sql
SELECT
  학번,
  SUM(점수) AS 총점,
  AVG(점수) AS 평균
FROM 성적표
GROUP BY 학번
```

<br>

### ROLLUP
- 그룹별 중간 집계값을 생성한다.
- DB에서 자동으로 소계를 만들어준다.

```sql
SELECT
  학번,
  학기,
  SUM(점수) AS 총점,
  AVG(점수) AS 평균
FROM 성적표
GROUP BY ROLLUP(학번, 학기)
```
|학번|학기|총점|평균|
|:---:|:---:|:---:|:---:|
|0001|1|155|77.5|
|0001|2|165|82.5|
|001|NULL|320|80|
|0002|1|160|80|
|0002|2|160|80|
|002|NULL|320|80|
|NULL|NULL|640|80|

<br>

### CUBE
- 결합 가능한 값에 대한 `다차원 집계`를 생성한다.
- 그룹핑 컬럼이 가질 수 있는 `모든 경우의 수`에 대해 `소계`와 `총계`를 생성한다.
- 시스템에 많은 부담을 주기 때문에 대용량 데이터에서는 적합하지 않다.

```sql
SELECT
  학번,
  학기,
  SUM(점수) AS 총점,
  AVG(점수) AS 평균
FROM 성적표
GROUP BY CUBE(학번, 학기)
```

<br>

### GROUPING SETS
- 개별 집계를 구한다.
- ROLLUP과 CUBE와 달리 계층 구조가 나타나지 않으며 따라서 인자의 순서가 달라도 결과는 똑같다.
- GROUPING SETS 함수는 괄호로 묶은 집합별로도 집계를 생성할 수 있다.

```sql
SELECT
  학번,
  학기,
  SUM(점수) AS 총점,
  AVG(점수) AS 평균
FROM 성적표
GROUP BY GROUPING SETS(학번, 학기)
```

<br>

## 집계함수
### COUNT
- 행위 `개수`를 반환한다.
### SUM
- 특정 컬럼의 `합계`를 반환한다.
### AVG
- 특정 컬럼의 `평균`을 반환한다.
### MAX
- 특정 컬럼에서 `최대값`을 반환한다.
### MIN
- 특정 컬럼에서 `최소값`을 반환한다.
### STDDEV
- 특정 컬럼간의 `표준편차`를 반환한다.
### VARIAN
- 특정 컬럼간의 `분산`을 반환한다.
